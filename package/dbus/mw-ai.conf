<?xml version="1.0"?>
<busconfig>

  <!-- only root can own com.sky.dobby -->
  <policy user="root">
    <allow own="com.sky.dobby"/>
    <allow send_destination="com.sky.dobby"/>
    <allow send_interface="com.sky.dobby.hook1"/>
  </policy>

  <!-- allow test clients as root -->
  <policy user="root">
    <allow own_prefix="com.sky.dobby.test"/>
    <allow send_destination="com.sky.dobby" send_interface="com.sky.dobby.admin1"/>
    <allow send_destination="com.sky.dobby" send_interface="com.sky.dobby.ctrl1"/>
    <allow send_destination="com.sky.dobby" send_interface="com.sky.dobby.debug1"/>
  </policy>

  <!-- M/W can talk to the dobby daemon admin and ctrl interfaces -->
  <policy user="NDS_U3">
    <allow own="com.sky.ai.app_process"/>
    <allow send_destination="com.sky.dobby" send_interface="com.sky.dobby.admin1"/>
    <allow send_destination="com.sky.dobby" send_interface="com.sky.dobby.ctrl1"/>
  </policy>


  <!-- Allow the APP_Process limited access to control the AI Dobby daemon on upstart -->
  <policy user="NDS_U3">
    <allow send_destination="com.ubuntu.Upstart"
           send_interface="com.ubuntu.Upstart0_6.Job"
           send_path="/com/ubuntu/Upstart/jobs/skyDobbyDaemon"/>
  </policy>

</busconfig>

